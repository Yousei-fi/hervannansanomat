{% extends "base.twig" %}

{% block content %}
    {% if posts %}
        {% set featured = posts|first %}
        {% set rest = posts|slice(1) %}

        <section class="bg-gradient-to-b from-white via-brand-smoke/60 to-brand-light py-10 md:py-14">
            <div class="container grid gap-10 lg:grid-cols-2 lg:items-center">
                <div class="space-y-4">
                    <p class="eyebrow">Tuorein juttu</p>
                    <h1 class="text-4xl font-serif font-semibold text-brand-dark md:text-5xl">{{ featured.title }}</h1>
                    <div class="meta">
                        <span>{{ featured.date('j.n.Y') }}</span>
                        {% set cats = featured.terms('category') %}
                        {% if cats %}
                            <span class="flex flex-wrap gap-2">
                                {% for cat in cats %}
                                    <span class="badge">{{ cat.name }}</span>
                                {% endfor %}
                            </span>
                        {% endif %}
                    </div>
                    {% if featured.excerpt %}
                        <p class="text-lg text-gray-700">{{ featured.excerpt({ words: 32 }) }}</p>
                    {% endif %}
                    <div class="flex gap-3">
                        <a href="{{ featured.link }}" class="btn-primary">Lue juttu</a>
                        <a href="{{ function('get_permalink', function('get_option','page_for_posts')) }}" class="btn-secondary">Näytä kaikki</a>
                    </div>
                </div>
                <div class="relative">
                    {% if featured.thumbnail %}
                        <div class="rounded-2xl bg-white p-2 shadow-card ring-1 ring-black/5">
                            <img src="{{ featured.thumbnail.src('large') }}" alt="{{ featured.title }}" class="h-full w-full rounded-xl object-cover">
                        </div>
                    {% else %}
                        <div class="rounded-2xl bg-white p-10 shadow-card ring-1 ring-black/5">
                            <p class="text-gray-500">Ei esittelykuvaa</p>
                        </div>
                    {% endif %}
                </div>
            </div>
        </section>

        <section class="container py-12 space-y-8">
            <div class="flex flex-col gap-3 md:flex-row md:items-center md:justify-between">
                <div>
                    <p class="eyebrow">Uutiset</p>
                    <h2 class="section-heading">Tuoreimmat Hervannan kuulumiset</h2>
                    <p class="section-copy">Yliopisto, yritykset, tapahtumat ja arki – koottuna samaan lehteen.</p>
                </div>
                <div class="flex flex-wrap gap-2">
                    <a class="btn-ghost" href="{{ function('get_home_url') }}/?s=">Hae</a>
                </div>
            </div>

            {% if rest %}
                <div class="grid gap-6 md:grid-cols-2 lg:grid-cols-3">
                    {% for post in rest %}
                        <article class="card h-full flex flex-col">
                            {% if post.thumbnail %}
                                <a href="{{ post.link }}" class="block">
                                    <img src="{{ post.thumbnail.src('medium_large') }}" alt="{{ post.title }}" class="h-48 w-full object-cover">
                                </a>
                            {% endif %}
                            <div class="card-body flex-1">
                                <div class="meta">
                                    <span>{{ post.date('j.n.Y') }}</span>
                                    {% set cats = post.terms('category') %}
                                    {% if cats %}
                                        <span class="flex flex-wrap gap-1">
                                            {% for cat in cats %}
                                                <span class="badge">{{ cat.name }}</span>
                                            {% endfor %}
                                        </span>
                                    {% endif %}
                                </div>
                                <h3 class="text-xl font-serif font-semibold text-brand-dark">
                                    <a href="{{ post.link }}">{{ post.title }}</a>
                                </h3>
                                {% if post.excerpt %}
                                    <p class="text-gray-600">{{ post.excerpt({ words: 26 }) }}</p>
                                {% endif %}
                                <div class="mt-auto pt-3">
                                    <a class="btn-ghost" href="{{ post.link }}">Lue lisää →</a>
                                </div>
                            </div>
                        </article>
                    {% endfor %}
                </div>
            {% endif %}

            {% set pagination = posts.pagination({ mid_size: 1 }) %}
            {% if pagination.pages %}
                <nav class="flex flex-wrap items-center justify-center gap-2 pt-6" aria-label="Sivutus">
                    {% for page in pagination.pages %}
                        {% set is_current = page.class is defined and 'current' in page.class %}
                        {% if page.link %}
                            <a href="{{ page.link }}" class="btn-ghost px-4 py-2 {{ is_current ? 'font-bold text-brand-dark' : '' }}">{{ page.title }}</a>
                        {% else %}
                            <span class="btn-ghost px-4 py-2 cursor-default opacity-70">{{ page.title }}</span>
                        {% endif %}
                    {% endfor %}
                </nav>
            {% endif %}
        </section>
    {% else %}
        <section class="container py-16">
            <p>Ei artikkeleita vielä.</p>
        </section>
    {% endif %}
{% endblock %}

